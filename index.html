<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Pedrad - Entregador</title>
    <meta name="theme-color" content="#22c55e">
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="toast" id="toast"></div>
    
    <!-- Auth Page -->
    <div id="authPage" class="auth-container">
        <div class="auth-logo">
            <h1>ğŸ›µ Pedrad</h1>
            <p>App do Entregador</p>
        </div>
        <div class="auth-box">
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">E-mail</label>
                    <input type="email" class="form-input" id="loginEmail" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Entrar</button>
            </form>
            <p class="auth-hint">Credenciais fornecidas pelo administrador</p>
        </div>
    </div>
    
    <!-- Main App -->
    <div id="mainApp" style="display: none;">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="header-title">ğŸ›µ Pedrad</div>
            </div>
            <div class="header-status">
                <span class="status-text" id="statusText">Offline</span>
                <div class="toggle" id="onlineToggle" onclick="toggleOnline()"></div>
            </div>
        </header>
        
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <!-- Driver Info Card -->
            <div class="driver-card" id="driverCard">
                <div class="driver-avatar" id="driverAvatar" onclick="changeProfilePhoto()">ğŸ›µ</div>
                <div class="driver-info">
                    <div class="driver-name" id="driverName">Carregando...</div>
                    <div class="driver-vehicle" id="driverVehicle">-</div>
                </div>
                <div class="driver-rating">
                    <span>â­</span>
                    <span id="driverRating">5.0</span>
                </div>
            </div>
            
            <!-- Stats -->
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-value money" id="todayEarnings">R$ 0</div>
                    <div class="stat-label">Ganhos hoje</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="todayDeliveries">0</div>
                    <div class="stat-label">Entregas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="todayDistance">0 km</div>
                    <div class="stat-label">Percorrido</div>
                </div>
            </div>
            
            <!-- Current Delivery -->
            <div id="currentDeliverySection" style="display: none;">
                <div class="section-title">ğŸš€ Entrega Atual</div>
                <div class="current-delivery" id="currentDelivery"></div>
            </div>

            <!-- Accepted Orders (nÃ£o iniciadas) -->
            <div id="acceptedSection" style="display: none;">
                <div class="section-title">
                    â³ Minhas Entregas Aceitas
                    <span class="section-badge" id="acceptedCount">0</span>
                </div>
                <div id="acceptedOrders"></div>
            </div>
            
            <!-- Available Deliveries -->
            <div id="availableSection">
                <div class="section-title">
                    ğŸ“¦ Entregas DisponÃ­veis
                    <span class="section-badge" id="availableCount">0</span>
                </div>
                <div id="availableDeliveries"></div>
            </div>
        </div>
        
        <!-- History Page -->
        <div id="historyPage" class="page">
            <div class="section-title">ğŸ“‹ HistÃ³rico</div>
            
            <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                <button class="btn btn-sm" id="filterToday" onclick="setHistoryFilter('today')">Hoje</button>
                <button class="btn btn-sm btn-primary" id="filterWeek" onclick="setHistoryFilter('week')">Semana</button>
                <button class="btn btn-sm" id="filterMonth" onclick="setHistoryFilter('month')">MÃªs</button>
            </div>

            <div class="stat-card" style="margin-bottom: 16px;">
                <div class="stat-value money" id="historyEarnings">R$ 0,00</div>
                <div class="stat-label">Total do perÃ­odo</div>
            </div>
            
            <div id="historyList"></div>
        </div>
        
        <!-- Earnings Page -->
        <div id="earningsPage" class="page">
            <div class="earnings-header">
                <div class="earnings-total">
                    <div class="earnings-label">Ganhos desta semana</div>
                    <div class="earnings-value" id="weekEarningsTotal">R$ 0,00</div>
                </div>
            </div>
            
            <div class="section-title">ğŸ“Š Resumo</div>
            <div class="earnings-stats">
                <div class="earnings-stat">
                    <div class="earnings-stat-icon">ğŸ“¦</div>
                    <div class="earnings-stat-info">
                        <div class="earnings-stat-value" id="weekDeliveriesCount">0</div>
                        <div class="earnings-stat-label">Entregas</div>
                    </div>
                </div>
                <div class="earnings-stat">
                    <div class="earnings-stat-icon">ğŸ›£ï¸</div>
                    <div class="earnings-stat-info">
                        <div class="earnings-stat-value" id="weekDistanceTotal">0 km</div>
                        <div class="earnings-stat-label">Percorridos</div>
                    </div>
                </div>
                <div class="earnings-stat">
                    <div class="earnings-stat-icon">â±ï¸</div>
                    <div class="earnings-stat-info">
                        <div class="earnings-stat-value" id="weekHoursTotal">0h</div>
                        <div class="earnings-stat-label">Online</div>
                    </div>
                </div>
            </div>
            
            <div class="section-title">ğŸ’³ Dados para Pagamento</div>
            <div class="pix-card" id="pixCard">
                <div class="pix-icon">ğŸ’°</div>
                <div class="pix-info">
                    <div class="pix-label">Chave PIX</div>
                    <div class="pix-value" id="pixKey">NÃ£o cadastrado</div>
                </div>
            </div>
        </div>
        
        <!-- Profile Page -->
        <div id="profilePage" class="page">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar" onclick="changeProfilePhoto()">ğŸ›µ</div>
                <div class="profile-name" id="profileName">Entregador</div>
                <div class="profile-email" id="profileEmail">email@exemplo.com</div>
            </div>
            
            <div class="profile-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalDeliveries">0</div>
                    <div class="stat-label">Total entregas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="profileRating">5.0</div>
                    <div class="stat-label">AvaliaÃ§Ã£o</div>
                </div>
            </div>
            
            <div class="profile-section">
                <div class="profile-section-title">InformaÃ§Ãµes</div>
                <div class="profile-item">
                    <span class="profile-item-icon">ğŸ“±</span>
                    <span class="profile-item-label">Telefone</span>
                    <span class="profile-item-value" id="profilePhone">-</span>
                </div>
                <div class="profile-item">
                    <span class="profile-item-icon">ğŸš—</span>
                    <span class="profile-item-label">VeÃ­culo</span>
                    <span class="profile-item-value" id="profileVehicle">-</span>
                </div>
                <div class="profile-item">
                    <span class="profile-item-icon">ğŸ”¢</span>
                    <span class="profile-item-label">Placa</span>
                    <span class="profile-item-value" id="profilePlate">-</span>
                </div>
                <div class="profile-item">
                    <span class="profile-item-icon">ğŸ“¦</span>
                    <span class="profile-item-label">Max. simultÃ¢neas</span>
                    <span class="profile-item-value" id="profileMaxOrders">1</span>
                </div>
            </div>
            
            <div class="profile-section">
                <div class="profile-section-title">Conta</div>
                <div class="profile-menu-item" onclick="showPage('earnings')">
                    <span class="profile-menu-icon">ğŸ’°</span>
                    <span class="profile-menu-text">Ganhos e Pagamentos</span>
                    <span class="profile-menu-arrow">â€º</span>
                </div>
                <div class="profile-menu-item" onclick="requestLocationPermission()">
                    <span class="profile-menu-icon">ğŸ“</span>
                    <span class="profile-menu-text">PermissÃ£o de LocalizaÃ§Ã£o</span>
                    <span class="profile-menu-arrow">â€º</span>
                </div>
                <div class="profile-menu-item logout" onclick="handleLogout()">
                    <span class="profile-menu-icon">ğŸšª</span>
                    <span class="profile-menu-text">Sair</span>
                    <span class="profile-menu-arrow">â€º</span>
                </div>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="nav">
            <div class="nav-item active" onclick="showPage('home')">
                <span>ğŸ </span>
                <span class="nav-label">InÃ­cio</span>
            </div>
            <div class="nav-item" onclick="showPage('history')">
                <span>ğŸ“‹</span>
                <span class="nav-label">HistÃ³rico</span>
            </div>
            <div class="nav-item" onclick="showPage('earnings')">
                <span>ğŸ’°</span>
                <span class="nav-label">Ganhos</span>
            </div>
            <div class="nav-item" onclick="showPage('profile')">
                <span>ğŸ‘¤</span>
                <span class="nav-label">Perfil</span>
            </div>
        </nav>
    </div>
    
    <!-- Accept Modal -->
    <div class="modal" id="acceptModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸ“¦</div>
            <div class="modal-title">Aceitar Entrega?</div>
            <div class="modal-text" id="acceptModalText">Loja â†’ Bairro</div>
            <div class="modal-info" id="acceptModalInfo"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('acceptModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="confirmAccept()">Aceitar</button>
            </div>
        </div>
    </div>
    
    <!-- Pickup Modal -->
    <div class="modal" id="pickupModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸª</div>
            <div class="modal-title">Retirou o pedido?</div>
            <div class="modal-text">Confirme que pegou o pedido na loja</div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('pickupModal')">Ainda nÃ£o</button>
                <button class="btn btn-warning" onclick="confirmPickup()">JÃ¡ peguei!</button>
            </div>
        </div>
    </div>
    
    <!-- Delivery Complete Modal -->
    <div class="modal" id="deliverModal">
        <div class="modal-content">
            <div class="modal-icon">âœ…</div>
            <div class="modal-title">Finalizar Entrega</div>
            <div class="modal-text">Confirme a entrega e envie sua localizaÃ§Ã£o</div>
            
            <div class="location-box" id="locationBox">
                <div class="location-status" id="locationStatus">
                    <span class="location-icon">ğŸ“</span>
                    <span class="location-text">Capturando localizaÃ§Ã£o...</span>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('deliverModal')">Cancelar</button>
                <button class="btn btn-success" onclick="confirmDelivery()" id="confirmDeliveryBtn" disabled>
                    â³ Aguarde GPS...
                </button>
            </div>
        </div>
    </div>
    
    <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="index.js"></script>
</body>
</html>
